var Tangular={};Tangular.helpers={},Tangular.register=function(r,e){return Tangular.helpers[r]=e,Tangular},Tangular.compile=function(r){r||(r="");for(var e=-1,n=[],i=-1,t=0,s=r.length,u=0;s>e++;){var a=r.substring(e,e+2);if(-1===i)if("{{"!==a);else{if(-1!==i){u++;continue}var l=r.substring(t,e);n.push(l?'unescape("'+escape(l)+'")':'""'),i=e+2}else if("}}"===a){if(u>0){u--;continue}n.push(r.substring(i,e).trim()),t=e+2,i=-1;continue}}n.push('unescape("'+escape(r.substring(t,s))+'")'),s=n.length;for(var g="$output+=",f='var $s=this;var $output="";',o=[],c=!1,p=0,d=0;s>d;d++)if(d%2!==0){var h=n[d],v=!1,e=h.lastIndexOf("|"),b="helpers.encode(@)",T=null,$=h.substring(0,3);"if "===$&&(h="if( "+h.substring(3)+"){",v=!0),"foreach "===h.substring(0,8)&&(T=h.split(" "),"var"===T[1]&&T.splice(1,1),o.push(T[1]),v=!0,c=!0,p++);var m=h.substring(0,5);if("endif"===m||"fi"===h?(h="}",v=!0):"else"===m?(h="} else {",v=!0):("end"===$||"endfor"===h.substring(0,6))&&(h=0===o.length?"}":"}})();",o.pop(),v=!0,p--,0===p&&(c=!1)),v)h=Tangular.append(h,o,c).trim();else{if(-1!==e){b=h.substring(e+1).trim(),h=h.substring(0,e),e=b.indexOf("(");var x=b;if(-1===e?b+="(@)":(x=b.substring(0,e),b=b.substring(0,e+1)+"@"+(-1===b.indexOf("()")?",":"")+b.substring(e+1)),b="helpers."+b,void 0===Tangular.helpers[x])throw new Error('Helper: "'+x+'" not found.')}e=b.indexOf("("),b=b.substring(0,e)+".call($s,"+b.substring(e+1),h=b.replace("@",Tangular.append(h,o,c).trim())}if(v){if(T){var w=Tangular.append(T[3],o,c);h="if ("+w+"===null||"+w+"===undefined)"+w+"=[];(function(){for(var i=0,length="+w+".length;i<length;i++){var "+T[1]+"="+w+"[i];var $index=i;"}f+=h}else f+=g+h+";"}else f+=g+n[d]+";";return function(r){return new Function("helpers",f+";return $output;").call(r,Tangular.helpers)}},Tangular.append=function(r,e){return void 0===e&&(e=[]),r.replace(/[\_\$a-zá-žÁ-ŽA-Z0-9\s]+/g,function(r,n,i){var t=i.substring(n-1,n),s=!1,u=r.trim();switch(('"'===t||"'"===t||"."===t)&&(s=!0),r.trim()){case"else":case"end":case"endfor":case"endif":case"fi":case"foreach":case"if":return r;case"$index":if(!s)return r}if(""===u)return"";if(s)return r;s=!1;for(var a=0,l=e.length;l>a;a++){var g=e[a].length;if(u.substring(0,g)===e[a]){if(u.length!==g){var t=u.substring(g,g+1);if("."!==t&&"+"!==t)continue}s=!0;break}}if(s)return u;t=u.substring(0,1);var f=t.charCodeAt(0);return f>47&&58>f?u:"$s."+u})},Tangular.render=function(r,e){return(void 0===e||null===e)&&(e={}),"string"==typeof r&&(r=Tangular.compile(r)),r(e)},Tangular.register("encode",function(r){return(void 0===r||null===r)&&(r=""),r.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),Tangular.register("raw",function(r){return(void 0===r||null===r)&&(r=""),r});