var Tangular={};Tangular.helpers={},Tangular.settings={delimiters:["{{","}}"]},Tangular.register=function(e,r){return Tangular.helpers[e]=r,Tangular},Tangular.compile=function(e){e||(e="");for(var r=-1,n=[],t=-1,i=0,a=e.length,s=0,u=Tangular.settings.delimiters[0].length;a>r++;){var l=e.substring(r,r+u);if(-1===t)if(l!==Tangular.settings.delimiters[0]);else{if(-1!==t){s++;continue}var g=e.substring(i,r);n.push(g?'unescape("'+escape(g)+'")':'""'),t=r+u}else if(l===Tangular.settings.delimiters[1]){if(s>0){s--;continue}n.push(e.substring(t,r).trim()),i=r+u,t=-1;continue}}n.push('unescape("'+escape(e.substring(i,a))+'")'),a=n.length;for(var f="$output+=",o='var $s=this,$output="",$t;',p=[],c=!1,d=0,h=0;a>h;h++)if(h%2!==0){var v=n[h],T=!1,r=v.lastIndexOf("|"),b=null,$=v.substring(0,3);"if "===$&&(v="if( "+v.substring(3)+"){",T=!0),"foreach "===v.substring(0,8)&&(b=v.split(" "),"var"===b[1]&&b.splice(1,1),p.push(b[1]),T=!0,c=!0,d++);var m=v.substring(0,5);if("endif"===m||"fi"===v?(v="}",T=!0):"else"===m?(v="} else {",T=!0):"else if"===v.substring(0,7)?(v="}else if( "+v.substring(8)+"){",T=!0):("end"===$||"endfor"===v.substring(0,6))&&(v=0===p.length?"}":"}})();",p.pop(),T=!0,d--,0===d&&(c=!1)),v=T?Tangular.append(v,p,c).trim():Tangular.helper(v,p,c),T){if(b){var x=Tangular.append(b[3],p,c);v="if ("+x+"===null||"+x+"===undefined)"+x+"=[];(function(){for(var i=0,length="+x+".length;i<length;i++){var "+b[1]+"="+x+"[i];var $index=i;"}o+=v}else o+=f+v+";"}else o+=f+n[h]+";";return function(e){return new Function("helpers",o+";return $output;").call(e,Tangular.helpers)}},Tangular.helper=function(e,r,n){var t,i=e.indexOf("|");if(-1===i)return t=Tangular.append(e.trim(),r,n).trim(),"helpers.encode.call($s,"+t+")";t=Tangular.append(e.substring(0,i).trim(),r,n).trim(),e=e.substring(i+1).trim().split("|");for(var a="",s=0,u=e.length;u>s;s++){var l,g=e[s].trim().replace("()","");if(i=g.indexOf("("),-1===i?(l=g,g=".call($s,$t)"):(l=g.substring(0,i),g=".call($s,$t,"+g.substring(i+1)),!Tangular.helpers[l])throw new Error('Helper: "'+l+'" not found.');g='$t=helpers["'+l+'"]'+g,a+=g+";"}return'"";$t='+t+";"+a+"$output+=$t"},Tangular.append=function(e,r){return void 0===r&&(r=[]),e.replace(/[\_\$a-zá-žÁ-ŽA-Z0-9\s]+/g,function(e,n,t){var i=t.substring(n-1,n),a=!1,s=e.trim();switch(('"'===i||"'"===i||"."===i)&&(a=!0),e.trim()){case"else":case"end":case"endfor":case"endif":case"fi":case"foreach":case"if":case"else if":return e;case"$index":if(!a)return e}if(""===s)return"";if(a)return e;a=!1;for(var u=0,l=r.length;l>u;u++){var g=r[u].length;if(s.substring(0,g)===r[u]){if(s.length!==g){var i=s.substring(g,g+1);if("."!==i&&"+"!==i)continue}a=!0;break}}if(a)return s;i=s.substring(0,1);var f=i.charCodeAt(0);return f>47&&58>f?s:"$s."+s})},Tangular.render=function(e,r){return(void 0===r||null===r)&&(r={}),"string"==typeof e&&(e=Tangular.compile(e)),e(r)},Tangular.register("encode",function(e){return(void 0===e||null===e)&&(e=""),e.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),Tangular.register("raw",function(e){return(void 0===e||null===e)&&(e=""),e});