var Tangular={};Tangular.helpers={},Tangular.register=function(r,e){return Tangular.helpers[r]=e,Tangular},Tangular.compile=function(r){r||(r="");for(var e=-1,n=[],t=-1,i=0,u=r.length,a=0;u>e++;){var s=r.substring(e,e+2);if(-1===t)if("{{"!==s);else{if(-1!==t){a++;continue}var l=r.substring(i,e);n.push(l?'unescape("'+escape(l)+'")':'""'),t=e+2}else if("}}"===s){if(a>0){a--;continue}n.push(r.substring(t,e).trim()),i=e+2,t=-1;continue}}n.push('unescape("'+escape(r.substring(i,u))+'")'),u=n.length;for(var g="$output+=",f='var $s=this,$output="",$t;',o=[],p=!1,c=0,d=0;u>d;d++)if(d%2!==0){var h=n[d],v=!1,e=h.lastIndexOf("|"),b=null,T=h.substring(0,3);"if "===T&&(h="if( "+h.substring(3)+"){",v=!0),"foreach "===h.substring(0,8)&&(b=h.split(" "),"var"===b[1]&&b.splice(1,1),o.push(b[1]),v=!0,p=!0,c++);var $=h.substring(0,5);if("endif"===$||"fi"===h?(h="}",v=!0):"else"===$?(h="} else {",v=!0):"else if"===h.substring(0,7)?(h="}else if( "+h.substring(8)+"){",v=!0):("end"===T||"endfor"===h.substring(0,6))&&(h=0===o.length?"}":"}})();",o.pop(),v=!0,c--,0===c&&(p=!1)),h=v?Tangular.append(h,o,p).trim():Tangular.helper(h,o,p),v){if(b){var m=Tangular.append(b[3],o,p);h="if ("+m+"===null||"+m+"===undefined)"+m+"=[];(function(){for(var i=0,length="+m+".length;i<length;i++){var "+b[1]+"="+m+"[i];var $index=i;"}f+=h}else f+=g+h+";"}else f+=g+n[d]+";";return function(r){return new Function("helpers",f+";return $output;").call(r,Tangular.helpers)}},Tangular.helper=function(r,e,n){var t,i=r.indexOf("|");if(-1===i)return t=Tangular.append(r.trim(),e,n).trim(),"helpers.encode("+t+")";t=Tangular.append(r.substring(0,i).trim(),e,n).trim(),r=r.substring(i+1).trim().split("|");for(var u="",a=0,s=r.length;s>a;a++){var l,g=r[a].trim().replace("()","");if(i=g.indexOf("("),-1===i?(l=g,g="($t)"):(l=g.substring(0,i),g="($t,"+g.substring(i+1)),!Tangular.helpers[l])throw new Error('Helper: "'+l+'" not found.');g='$t=helpers["'+l+'"]'+g,u+=g+";"}return'"";$t='+t+";"+u+"$output+=$t"},Tangular.append=function(r,e){return void 0===e&&(e=[]),r.replace(/[\_\$a-zá-žÁ-ŽA-Z0-9\s]+/g,function(r,n,t){var i=t.substring(n-1,n),u=!1,a=r.trim();switch(('"'===i||"'"===i||"."===i)&&(u=!0),r.trim()){case"else":case"end":case"endfor":case"endif":case"fi":case"foreach":case"if":case"else if":return r;case"$index":if(!u)return r}if(""===a)return"";if(u)return r;u=!1;for(var s=0,l=e.length;l>s;s++){var g=e[s].length;if(a.substring(0,g)===e[s]){if(a.length!==g){var i=a.substring(g,g+1);if("."!==i&&"+"!==i)continue}u=!0;break}}if(u)return a;i=a.substring(0,1);var f=i.charCodeAt(0);return f>47&&58>f?a:"$s."+a})},Tangular.render=function(r,e){return(void 0===e||null===e)&&(e={}),"string"==typeof r&&(r=Tangular.compile(r)),r(e)},Tangular.register("encode",function(r){return(void 0===r||null===r)&&(r=""),r.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),Tangular.register("raw",function(r){return(void 0===r||null===r)&&(r=""),r});